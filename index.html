<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>WebAuthn Explorer ‚Äî Understand & Test WebAuthn Features</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app-shell">
    <!-- ===== Header ===== -->
    <header>
      <div class="title-block">
        <h1>
          <span class="logo">üîê</span>
          WebAuthn Explorer
        </h1>
        <p class="subtitle">
          Understand and test WebAuthn Level 3 features on your device. Learn what capabilities your browser supports for passkeys and passwordless authentication.
        </p>
      </div>
      <div class="header-meta">
        <span id="envPill" class="pill">
          <span class="pill-dot"></span>
          <span id="envText">Detecting‚Ä¶</span>
        </span>
        <span id="browserPill" class="browser-pill"></span>
      </div>
    </header>

    <!-- ===== Navigation Tabs ===== -->
    <nav class="nav-tabs">
      <button class="nav-tab active" data-section="capabilities">
        <span class="nav-tab-icon">üìã</span>
        <span>Client Capabilities</span>
        <span class="nav-tab-badge">L3</span>
      </button>
      <button class="nav-tab" data-section="hints">
        <span class="nav-tab-icon">üéØ</span>
        <span>Authenticator Hints</span>
        <span class="nav-tab-badge">L3</span>
      </button>
      <button class="nav-tab" data-section="extensions">
        <span class="nav-tab-icon">üß©</span>
        <span>Extensions</span>
      </button>
      <button class="nav-tab" data-section="prf">
        <span class="nav-tab-icon">üé≤</span>
        <span>PRF Extension</span>
        <span class="nav-tab-badge">L3</span>
      </button>
      <button class="nav-tab" data-section="conditional">
        <span class="nav-tab-icon">‚ú®</span>
        <span>Conditional UI</span>
        <span class="nav-tab-badge">L3</span>
      </button>
    </nav>

    <!-- ===== Main Content ===== -->
    <main>
      <!-- ========== Section: Client Capabilities ========== -->
      <section id="section-capabilities" class="check-section active">
        <div class="section-header">
          <div class="section-title-block">
            <h2>
              <span>üìã</span>
              Client Capabilities
            </h2>
            <p>
              Query <code>PublicKeyCredential.getClientCapabilities()</code> to discover what WebAuthn features this browser/device supports.
            </p>
          </div>
          <div class="section-actions">
            <button id="runCapabilitiesBtn" class="primary">
              <span>‚ñ∂</span>
              <span>Run Check</span>
            </button>
            <button id="copyCapabilitiesBtn" class="secondary" disabled>
              <span>‚ßâ</span>
              <span>Copy JSON</span>
            </button>
          </div>
        </div>

        <div class="card-grid">
          <!-- Left: Dashboard -->
          <div class="card">
            <div class="card-inner">
              <div class="card-header">
                <div>
                  <div class="card-title">Dashboard</div>
                  <div class="card-subtitle">Interpreted capability results</div>
                </div>
                <div id="capStatusBadge" class="badge warn">
                  <span class="badge-dot"></span>
                  <span id="capStatusText">Not tested</span>
                </div>
              </div>

              <!-- Summary Stats -->
              <div id="capSummaryStats" class="summary-stats" style="display: none;">
                <div class="stat-box">
                  <span id="capStatSupported" class="stat-number green">0</span>
                  <span class="stat-label">Supported</span>
                </div>
                <div class="stat-box">
                  <span id="capStatUnsupported" class="stat-number red">0</span>
                  <span class="stat-label">Unsupported</span>
                </div>
                <div class="stat-box">
                  <span id="capStatUnknown" class="stat-number yellow">0</span>
                  <span class="stat-label">Unknown</span>
                </div>
              </div>

              <!-- Environment -->
              <div>
                <div class="section-label">Environment</div>
                <div class="env-grid">
                  <div class="env-item">
                    <div class="env-label">PublicKeyCredential</div>
                    <div class="env-value">
                      <span id="pkcIndicator" class="dot-indicator maybe"></span>
                      <span id="pkcText">Checking‚Ä¶</span>
                    </div>
                  </div>
                  <div class="env-item">
                    <div class="env-label">getClientCapabilities()</div>
                    <div class="env-value">
                      <span id="gccIndicator" class="dot-indicator maybe"></span>
                      <span id="gccText">Checking‚Ä¶</span>
                    </div>
                  </div>
                  <div class="env-item">
                    <div class="env-label">Legacy UVPAA</div>
                    <div class="env-value">
                      <span id="uvpaaIndicator" class="dot-indicator maybe"></span>
                      <span id="uvpaaText">Checking‚Ä¶</span>
                    </div>
                  </div>
                  <div class="env-item">
                    <div class="env-label">Conditional UI</div>
                    <div class="env-value">
                      <span id="conditionalIndicator" class="dot-indicator maybe"></span>
                      <span id="conditionalText">Checking‚Ä¶</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Capabilities List -->
              <div>
                <div class="section-label">Detected Capabilities</div>
                <div id="capabilitiesList" class="check-list">
                  <div class="check-item" style="opacity: 0.5;">
                    <div class="check-item-description">
                      Click "Run Check" to detect capabilities on this device.
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Right: Raw JSON -->
          <div class="card">
            <div class="card-inner">
              <div class="card-header">
                <div>
                  <div class="card-title">Raw JSON Output</div>
                  <div class="card-subtitle">Direct API response</div>
                </div>
              </div>
              <div class="log-container">
                <div class="log-header">
                  <span id="capLogLabel">Result appears after running check</span>
                  <span id="capLogMeta"></span>
                </div>
                <div id="capLog" class="log">{"info": "Click 'Run Check' to begin"}</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ========== Section: Authenticator Hints ========== -->
      <section id="section-hints" class="check-section">
        <div class="section-header">
          <div class="section-title-block">
            <h2>
              <span>üéØ</span>
              Authenticator Hints
            </h2>
            <p>
              Test the <code>hints</code> parameter (<code>PublicKeyCredentialHints</code>) which guides the browser on which type of authenticator to prefer during registration or authentication.
            </p>
          </div>
        </div>

        <div class="card-grid">
          <!-- Left: Hint Selector & Explanation -->
          <div class="card">
            <div class="card-inner">
              <div class="card-header">
                <div>
                  <div class="card-title">Hint Selection</div>
                  <div class="card-subtitle">Choose hints to include in your WebAuthn request</div>
                </div>
              </div>

              <div class="info-box">
                <strong>What are Hints?</strong><br>
                The <code>hints</code> property is an array of strings that suggest to the browser which authenticator type the relying party prefers. Hints are <strong>non-binding</strong> ‚Äî the browser may ignore them based on user preferences or available authenticators.
              </div>

              <div class="hint-selector">
                <div class="section-label">Available Hints (WebAuthn L3)</div>
                <div class="hint-options" id="hintOptions">
                  <label class="hint-option" data-hint="security-key">
                    <input type="checkbox" name="hint" value="security-key">
                    <span class="hint-checkbox">‚úì</span>
                    <div class="hint-label">
                      <span class="hint-label-name">üîë security-key</span>
                      <span class="hint-label-desc">Prefer roaming security keys (USB, NFC, BLE)</span>
                    </div>
                  </label>
                  <label class="hint-option" data-hint="client-device">
                    <input type="checkbox" name="hint" value="client-device">
                    <span class="hint-checkbox">‚úì</span>
                    <div class="hint-label">
                      <span class="hint-label-name">üíª client-device</span>
                      <span class="hint-label-desc">Prefer this device's built-in authenticator</span>
                    </div>
                  </label>
                  <label class="hint-option" data-hint="hybrid">
                    <input type="checkbox" name="hint" value="hybrid">
                    <span class="hint-checkbox">‚úì</span>
                    <div class="hint-label">
                      <span class="hint-label-name">üì± hybrid</span>
                      <span class="hint-label-desc">Prefer phone/tablet as authenticator (QR + BLE)</span>
                    </div>
                  </label>
                </div>
              </div>

              <div class="hint-result" id="hintResult">
                <div class="hint-result-title">Generated Options Object</div>
                <div class="hint-result-content">
                  <p style="margin: 0 0 8px; color: var(--text-muted); font-size: 0.78rem;">
                    This shows how the <code>hints</code> array would appear in your WebAuthn options:
                  </p>
                  <code id="hintCode" class="hint-code">hints: []</code>
                </div>
              </div>

              <div class="section-actions" style="margin-top: 8px;">
                <button id="testHintsCreateBtn" class="primary">
                  <span>‚ú®</span>
                  <span>Test with Create</span>
                </button>
                <button id="testHintsGetBtn" class="secondary">
                  <span>üîì</span>
                  <span>Test with Get</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Right: Explanation & Browser Support -->
          <div class="card">
            <div class="card-inner">
              <div class="card-header">
                <div>
                  <div class="card-title">Understanding Hints</div>
                  <div class="card-subtitle">How browsers interpret authenticator hints</div>
                </div>
              </div>

              <div class="check-list" id="hintsExplanationList">
                <!-- security-key -->
                <div class="check-item">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span class="dot-indicator ok"></span>
                      <span>üîë security-key</span>
                    </span>
                  </div>
                  <div class="check-item-summary">
                    Suggests the relying party prefers a <strong>roaming authenticator</strong> like a USB security key, NFC token, or Bluetooth device.
                  </div>
                  <div class="check-item-toggle" onclick="this.parentElement.classList.toggle('expanded')">
                    <span>‚ñ∂</span>
                    <span class="toggle-text">Learn more</span>
                    <span class="toggle-text-collapse">Show less</span>
                  </div>
                  <div class="check-item-details">
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Hardware-backed security</div>
                        <div class="detail-explanation">‚Ä¶credentials live on a physical device that can't be remotely compromised.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Device-bound, non-syncable</div>
                        <div class="detail-explanation">‚Ä¶the private key never leaves the security key hardware.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Portable across devices</div>
                        <div class="detail-explanation">‚Ä¶plug the same key into any computer to authenticate.</div>
                      </div>
                    </div>
                    <div class="use-case-box">
                      <div class="use-case-title">üí° When to use</div>
                      <div class="use-case-text">High-security environments where you need phishing-resistant, hardware-bound credentials. Common for enterprise SSO, admin accounts, or compliance requirements (NIST, PCI-DSS).</div>
                    </div>
                    <div class="code-example">hints: ["security-key"]</div>
                  </div>
                </div>

                <!-- client-device -->
                <div class="check-item">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span class="dot-indicator ok"></span>
                      <span>üíª client-device</span>
                    </span>
                  </div>
                  <div class="check-item-summary">
                    Suggests the relying party prefers the <strong>platform authenticator</strong> built into the current device ‚Äî Touch ID, Face ID, Windows Hello.
                  </div>
                  <div class="check-item-toggle" onclick="this.parentElement.classList.toggle('expanded')">
                    <span>‚ñ∂</span>
                    <span class="toggle-text">Learn more</span>
                    <span class="toggle-text-collapse">Show less</span>
                  </div>
                  <div class="check-item-details">
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Zero friction authentication</div>
                        <div class="detail-explanation">‚Ä¶users tap their finger or glance at the camera ‚Äî done.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">No external hardware needed</div>
                        <div class="detail-explanation">‚Ä¶works with what's already built into the device.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">May sync across devices</div>
                        <div class="detail-explanation">‚Ä¶depending on platform (iCloud Keychain, Google Password Manager).</div>
                      </div>
                    </div>
                    <div class="use-case-box">
                      <div class="use-case-title">üí° When to use</div>
                      <div class="use-case-text">Consumer apps prioritizing ease of use. Best for returning users on trusted personal devices where you want the fastest possible login experience.</div>
                    </div>
                    <div class="code-example">hints: ["client-device"]</div>
                  </div>
                </div>

                <!-- hybrid -->
                <div class="check-item">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span class="dot-indicator ok"></span>
                      <span>üì± hybrid</span>
                    </span>
                  </div>
                  <div class="check-item-summary">
                    Suggests the relying party prefers <strong>cross-device authentication</strong> using a phone as the authenticator via QR code + Bluetooth.
                  </div>
                  <div class="check-item-toggle" onclick="this.parentElement.classList.toggle('expanded')">
                    <span>‚ñ∂</span>
                    <span class="toggle-text">Learn more</span>
                    <span class="toggle-text-collapse">Show less</span>
                  </div>
                  <div class="check-item-details">
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Desktop shows QR code</div>
                        <div class="detail-explanation">‚Ä¶user scans it with their phone's camera.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Authenticate on your phone</div>
                        <div class="detail-explanation">‚Ä¶using Face ID, Touch ID, or fingerprint on the mobile device.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Bluetooth verifies proximity</div>
                        <div class="detail-explanation">‚Ä¶ensures the phone is physically nearby (anti-phishing protection).</div>
                      </div>
                    </div>
                    <div class="use-case-box">
                      <div class="use-case-title">üí° When to use</div>
                      <div class="use-case-text">Shared computers, public terminals, or devices without biometrics. Perfect for library computers, hotel business centers, or when users are on someone else's machine.</div>
                    </div>
                    <div class="code-example">hints: ["hybrid"]</div>
                  </div>
                </div>
              </div>

              <div class="info-box" style="margin-top: 12px;">
                <strong>‚ö†Ô∏è Hints are Non-Binding</strong><br>
                The browser may ignore hints based on user preferences, available authenticators, or platform policies. Hints guide the UI ‚Äî they don't restrict options.
              </div>

              <div class="info-box" style="margin-top: 8px;">
                <strong>üìã Ordering Matters</strong><br>
                Hints are processed in array order. The first hint is the strongest preference. Example: <code>["client-device", "hybrid"]</code> means "prefer platform authenticator, but offer phone-as-key as fallback."
              </div>

              <div id="hintTestResult" class="hint-result" style="display: none; margin-top: 12px;">
                <div class="hint-result-title">Test Result</div>
                <div class="hint-result-content" id="hintTestResultContent"></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ========== Section: WebAuthn Extensions ========== -->
      <section id="section-extensions" class="check-section">
        <div class="section-header">
          <div class="section-title-block">
            <h2>
              <span>üß©</span>
              WebAuthn Extensions
            </h2>
            <p>
              Extensions add optional functionality to WebAuthn operations. Specify them in the <code>extensions</code> property of your create/get options.
            </p>
          </div>
          <div class="section-actions">
            <button id="testExtensionsBtn" class="primary">
              <span>üß™</span>
              <span>Test Extension Support</span>
            </button>
          </div>
        </div>

        <!-- Extension Support Detector -->
        <div id="extensionDetectorCard" class="card" style="margin-bottom: 18px;">
          <div class="card-inner">
            <div class="card-header">
              <div>
                <div class="card-title">Extension Support Detector</div>
                <div class="card-subtitle">Test which extensions your device and browser actually support</div>
              </div>
              <div id="extTestBadge" class="badge warn">
                <span class="badge-dot"></span>
                <span id="extTestStatus">Not tested</span>
              </div>
            </div>

            <div class="info-box">
              <strong>üß™ How this works:</strong><br>
              Clicking "Test Extension Support" will create a temporary credential with all extensions enabled, then check which ones returned data. This requires completing the WebAuthn prompt.
            </div>

            <div id="extensionResults" class="check-list" style="margin-top: 12px;">
              <div class="check-item" style="opacity: 0.5;">
                <div class="check-item-description">
                  Click "Test Extension Support" to detect which extensions work on this device.
                </div>
              </div>
            </div>

            <div id="extensionRawResults" style="display: none; margin-top: 12px;">
              <div class="section-label">Raw Extension Results</div>
              <div id="extensionResultsLog" class="log" style="max-height: 200px;"></div>
            </div>
          </div>
        </div>

        <div class="card-grid">
          <!-- Left: Core Extensions -->
          <div class="card">
            <div class="card-inner">
              <div class="card-header">
                <div>
                  <div class="card-title">Core Extensions</div>
                  <div class="card-subtitle">Commonly used extensions for passkey implementations</div>
                </div>
              </div>

              <div class="check-list" id="coreExtensionsList">
                <!-- credProps -->
                <div class="check-item">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span class="dot-indicator ok"></span>
                      <span>üìù credProps</span>
                    </span>
                  </div>
                  <div class="check-item-summary">
                    Get information about the credential that was just created, including whether it's <strong>discoverable</strong> (resident).
                  </div>
                  <div class="check-item-toggle" onclick="this.parentElement.classList.toggle('expanded')">
                    <span>‚ñ∂</span>
                    <span class="toggle-text">Learn more</span>
                    <span class="toggle-text-collapse">Show less</span>
                  </div>
                  <div class="check-item-details">
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Know if credential is discoverable</div>
                        <div class="detail-explanation">‚Ä¶the rk (resident key) property tells you if it's stored on the authenticator.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Verify authenticator compliance</div>
                        <div class="detail-explanation">‚Ä¶confirm the authenticator respected your residentKey preference.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Adjust your UX accordingly</div>
                        <div class="detail-explanation">‚Ä¶show different flows for discoverable vs. server-side credentials.</div>
                      </div>
                    </div>
                    <div class="use-case-box">
                      <div class="use-case-title">üí° When to use</div>
                      <div class="use-case-text">Essential when you request residentKey: 'preferred'. The authenticator might not support it, so credProps tells you what actually happened.</div>
                    </div>
                    <div class="code-example">extensions: { credProps: true }
// Response: { rk: true }</div>
                  </div>
                </div>

                <!-- largeBlob -->
                <div class="check-item">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span class="dot-indicator ok"></span>
                      <span>üíæ largeBlob</span>
                    </span>
                  </div>
                  <div class="check-item-summary">
                    Store and retrieve arbitrary data (up to ~4KB) alongside a credential on the authenticator.
                  </div>
                  <div class="check-item-toggle" onclick="this.parentElement.classList.toggle('expanded')">
                    <span>‚ñ∂</span>
                    <span class="toggle-text">Learn more</span>
                    <span class="toggle-text-collapse">Show less</span>
                  </div>
                  <div class="check-item-details">
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Store data with the credential</div>
                        <div class="detail-explanation">‚Ä¶like encryption keys, certificates, or user preferences.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Data travels with the credential</div>
                        <div class="detail-explanation">‚Ä¶if passkeys sync, the blob syncs too.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Read data during authentication</div>
                        <div class="detail-explanation">‚Ä¶retrieve the blob when the user signs in.</div>
                      </div>
                    </div>
                    <div class="use-case-box">
                      <div class="use-case-title">üí° When to use</div>
                      <div class="use-case-text">Advanced use case: store a wrapped encryption key so users can decrypt data on any device where their passkey syncs. Also useful for offline-first apps.</div>
                    </div>
                    <div class="code-example">// Write
extensions: { largeBlob: { write: new Uint8Array([...]) } }
// Read
extensions: { largeBlob: { read: true } }</div>
                  </div>
                </div>

                <!-- PRF -->
                <div class="check-item">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span class="dot-indicator ok"></span>
                      <span>üé≤ prf (Pseudo-Random Function)</span>
                    </span>
                  </div>
                  <div class="check-item-summary">
                    Derive deterministic secret keys from a credential ‚Äî the same input always produces the same output.
                  </div>
                  <div class="check-item-toggle" onclick="this.parentElement.classList.toggle('expanded')">
                    <span>‚ñ∂</span>
                    <span class="toggle-text">Learn more</span>
                    <span class="toggle-text-collapse">Show less</span>
                  </div>
                  <div class="check-item-details">
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Generate encryption keys</div>
                        <div class="detail-explanation">‚Ä¶derive keys for encrypting user data client-side.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Deterministic output</div>
                        <div class="detail-explanation">‚Ä¶same credential + same input = same derived key, every time.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">No server storage needed</div>
                        <div class="detail-explanation">‚Ä¶the key is derived on-demand, never stored.</div>
                      </div>
                    </div>
                    <div class="use-case-box">
                      <div class="use-case-title">üí° When to use</div>
                      <div class="use-case-text">End-to-end encryption without key escrow. Derive encryption keys from the passkey itself ‚Äî if the passkey syncs, the encryption capability follows.</div>
                    </div>
                    <div class="code-example">extensions: {
  prf: { eval: { first: new Uint8Array(32) } }
}</div>
                  </div>
                </div>

                <!-- devicePubKey -->
                <div class="check-item">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span class="dot-indicator ok"></span>
                      <span>üîê devicePubKey</span>
                    </span>
                  </div>
                  <div class="check-item-summary">
                    Get a device-bound key in addition to the credential, enabling device binding for synced passkeys.
                  </div>
                  <div class="check-item-toggle" onclick="this.parentElement.classList.toggle('expanded')">
                    <span>‚ñ∂</span>
                    <span class="toggle-text">Learn more</span>
                    <span class="toggle-text-collapse">Show less</span>
                  </div>
                  <div class="check-item-details">
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Separate device-bound key</div>
                        <div class="detail-explanation">‚Ä¶doesn't sync, stays on this specific device.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Detect new devices</div>
                        <div class="detail-explanation">‚Ä¶know when a synced passkey is used from a new device.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Step-up authentication trigger</div>
                        <div class="detail-explanation">‚Ä¶prompt additional verification for unknown devices.</div>
                      </div>
                    </div>
                    <div class="use-case-box">
                      <div class="use-case-title">üí° When to use</div>
                      <div class="use-case-text">Banks and high-security apps: even with synced passkeys, detect when authentication comes from a new device and trigger additional verification.</div>
                    </div>
                    <div class="code-example">extensions: { devicePubKey: { attestation: "direct" } }</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Right: Security & Compatibility Extensions -->
          <div class="card">
            <div class="card-inner">
              <div class="card-header">
                <div>
                  <div class="card-title">Security & Compatibility</div>
                  <div class="card-subtitle">Extensions for security policies and legacy support</div>
                </div>
              </div>

              <div class="check-list">
                <!-- credProtect -->
                <div class="check-item">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span class="dot-indicator ok"></span>
                      <span>üõ°Ô∏è credProtect</span>
                    </span>
                  </div>
                  <div class="check-item-summary">
                    Control when and how a credential can be used ‚Äî restrict to user verification or specific use cases.
                  </div>
                  <div class="check-item-toggle" onclick="this.parentElement.classList.toggle('expanded')">
                    <span>‚ñ∂</span>
                    <span class="toggle-text">Learn more</span>
                    <span class="toggle-text-collapse">Show less</span>
                  </div>
                  <div class="check-item-details">
                    <div class="detail-point">
                      <span class="detail-icon">1Ô∏è‚É£</span>
                      <div class="detail-content">
                        <div class="detail-title">Level 1: userVerificationOptional</div>
                        <div class="detail-explanation">‚Ä¶credential usable with or without UV (default).</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">2Ô∏è‚É£</span>
                      <div class="detail-content">
                        <div class="detail-title">Level 2: userVerificationOptionalWithCredentialIDList</div>
                        <div class="detail-explanation">‚Ä¶discoverable only if credential ID is provided.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">3Ô∏è‚É£</span>
                      <div class="detail-content">
                        <div class="detail-title">Level 3: userVerificationRequired</div>
                        <div class="detail-explanation">‚Ä¶credential ONLY works with user verification.</div>
                      </div>
                    </div>
                    <div class="use-case-box">
                      <div class="use-case-title">üí° When to use</div>
                      <div class="use-case-text">High-security scenarios where you want to ensure the credential can't be used without biometric/PIN verification, even if the RP doesn't request it.</div>
                    </div>
                    <div class="code-example">extensions: {
  credentialProtectionPolicy: "userVerificationRequired",
  enforceCredentialProtectionPolicy: true
}</div>
                  </div>
                </div>

                <!-- minPinLength -->
                <div class="check-item">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span class="dot-indicator ok"></span>
                      <span>üî¢ minPinLength</span>
                    </span>
                  </div>
                  <div class="check-item-summary">
                    Request authenticators enforce a minimum PIN length for added security.
                  </div>
                  <div class="check-item-toggle" onclick="this.parentElement.classList.toggle('expanded')">
                    <span>‚ñ∂</span>
                    <span class="toggle-text">Learn more</span>
                    <span class="toggle-text-collapse">Show less</span>
                  </div>
                  <div class="check-item-details">
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Enforce PIN complexity</div>
                        <div class="detail-explanation">‚Ä¶require PINs of at least N characters.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Query current PIN length policy</div>
                        <div class="detail-explanation">‚Ä¶check what minimum the authenticator currently enforces.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Meet compliance requirements</div>
                        <div class="detail-explanation">‚Ä¶satisfy enterprise security policies.</div>
                      </div>
                    </div>
                    <div class="use-case-box">
                      <div class="use-case-title">üí° When to use</div>
                      <div class="use-case-text">Enterprise deployments where security policies require PINs of a certain length. Useful for FIDO2 security key rollouts.</div>
                    </div>
                    <div class="code-example">extensions: { minPinLength: true }</div>
                  </div>
                </div>

                <!-- uvm -->
                <div class="check-item">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span class="dot-indicator ok"></span>
                      <span>üîç uvm (User Verification Method)</span>
                    </span>
                  </div>
                  <div class="check-item-summary">
                    Learn which method the user used to verify their identity ‚Äî fingerprint, face, PIN, etc.
                  </div>
                  <div class="check-item-toggle" onclick="this.parentElement.classList.toggle('expanded')">
                    <span>‚ñ∂</span>
                    <span class="toggle-text">Learn more</span>
                    <span class="toggle-text-collapse">Show less</span>
                  </div>
                  <div class="check-item-details">
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Know how the user authenticated</div>
                        <div class="detail-explanation">‚Ä¶fingerprint, face recognition, PIN, or presence.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Audit and compliance logging</div>
                        <div class="detail-explanation">‚Ä¶record the verification method for security audits.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Adaptive security decisions</div>
                        <div class="detail-explanation">‚Ä¶require stronger UV for sensitive operations.</div>
                      </div>
                    </div>
                    <div class="use-case-box">
                      <div class="use-case-title">üí° When to use</div>
                      <div class="use-case-text">Security auditing and compliance. Know if the user used a biometric (stronger) vs. PIN (weaker) so you can make risk-based decisions.</div>
                    </div>
                    <div class="code-example">extensions: { uvm: true }
// Response: [[0x02, 0x04, 0x02]] ‚Üí fingerprint</div>
                  </div>
                </div>

                <!-- appid -->
                <div class="check-item">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span class="dot-indicator ok"></span>
                      <span>üîÑ appid (U2F Compatibility)</span>
                    </span>
                  </div>
                  <div class="check-item-summary">
                    Allow WebAuthn to authenticate with credentials originally registered via the legacy U2F API.
                  </div>
                  <div class="check-item-toggle" onclick="this.parentElement.classList.toggle('expanded')">
                    <span>‚ñ∂</span>
                    <span class="toggle-text">Learn more</span>
                    <span class="toggle-text-collapse">Show less</span>
                  </div>
                  <div class="check-item-details">
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Migrate from U2F to WebAuthn</div>
                        <div class="detail-explanation">‚Ä¶existing U2F credentials keep working.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Specify the original App ID</div>
                        <div class="detail-explanation">‚Ä¶the U2F appId used during registration.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Gradual migration path</div>
                        <div class="detail-explanation">‚Ä¶no need to re-register all users at once.</div>
                      </div>
                    </div>
                    <div class="use-case-box">
                      <div class="use-case-title">üí° When to use</div>
                      <div class="use-case-text">If you previously used U2F (chrome.runtime.sendMessage or the u2f-api.js polyfill), use appid to let those old credentials work with WebAuthn.</div>
                    </div>
                    <div class="code-example">extensions: { appid: "https://example.com" }</div>
                  </div>
                </div>

                <!-- SPC -->
                <div class="check-item">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span class="dot-indicator ok"></span>
                      <span>üí≥ Secure Payment Confirmation</span>
                    </span>
                  </div>
                  <div class="check-item-summary">
                    Streamlined payment authentication that shows transaction details in the WebAuthn prompt.
                  </div>
                  <div class="check-item-toggle" onclick="this.parentElement.classList.toggle('expanded')">
                    <span>‚ñ∂</span>
                    <span class="toggle-text">Learn more</span>
                    <span class="toggle-text-collapse">Show less</span>
                  </div>
                  <div class="check-item-details">
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Display transaction details</div>
                        <div class="detail-explanation">‚Ä¶amount, merchant, currency shown in browser UI.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">User confirms with biometric</div>
                        <div class="detail-explanation">‚Ä¶one gesture to authenticate and confirm payment.</div>
                      </div>
                    </div>
                    <div class="detail-point">
                      <span class="detail-icon">‚úî</span>
                      <div class="detail-content">
                        <div class="detail-title">Cryptographic proof of consent</div>
                        <div class="detail-explanation">‚Ä¶the signature covers the transaction details.</div>
                      </div>
                    </div>
                    <div class="use-case-box">
                      <div class="use-case-title">üí° When to use</div>
                      <div class="use-case-text">Online checkout flows. Replace SMS OTP or card CVV with a single biometric confirmation that proves the user saw and approved the exact transaction.</div>
                    </div>
                    <div class="code-example">const payment = new PaymentRequest([{
  supportedMethods: "secure-payment-confirmation",
  data: { credentialIds, challenge, ... }
}], details);</div>
                  </div>
                </div>
              </div>

              <div class="info-box" style="margin-top: 12px;">
                <strong>üìö Extension Support Varies</strong><br>
                Not all authenticators or browsers support all extensions. Always check the extension output in the response to confirm your request was honored. Use feature detection when available.
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ========== Section: PRF Extension ========== -->
      <section id="section-prf" class="check-section">
        <div class="section-header">
          <div class="section-title-block">
            <h2>
              <span>üé≤</span>
              PRF Extension (Pseudo-Random Function)
            </h2>
            <p>
              Derive deterministic cryptographic keys from your passkey ‚Äî perfect for end-to-end encryption without storing keys on a server.
            </p>
          </div>
        </div>

        <div class="card-grid">
          <!-- Left: Education - What is PRF -->
          <div class="card">
            <div class="card-inner">
              <div class="card-header">
                <div>
                  <div class="card-title">üìö Education</div>
                  <div class="card-subtitle">Understanding the PRF extension</div>
                </div>
              </div>

              <!-- What is PRF -->
              <div class="prf-education-block">
                <div class="section-label">What is PRF?</div>
                <div class="info-box" style="margin-top: 8px;">
                  <p style="margin: 0 0 12px;">
                    <strong>PRF (Pseudo-Random Function)</strong> is a WebAuthn extension that lets you derive <em>deterministic secret keys</em> from a passkey credential.
                  </p>
                  <p style="margin: 0 0 12px;">
                    Think of it as a <strong>"secret key generator"</strong> built into your passkey. Given the same input, it always produces the same output ‚Äî but without the passkey, the output is impossible to predict.
                  </p>
                  <p style="margin: 0;">
                    üîê <strong>Key insight:</strong> The derived key never leaves the authenticator and is never stored anywhere. It's regenerated fresh each time you authenticate.
                  </p>
                </div>
              </div>

              <!-- How does it work -->
              <div class="prf-education-block" style="margin-top: 16px;">
                <div class="section-label">How Does It Work?</div>
                <div class="check-list" style="margin-top: 8px;">
                  <div class="check-item">
                    <div class="check-item-header">
                      <span class="check-item-name">
                        <span class="dot-indicator ok"></span>
                        <span>1Ô∏è‚É£ You provide a "salt" (input value)</span>
                      </span>
                    </div>
                    <div class="check-item-summary">
                      A salt is just a random or application-specific value you pass to the PRF. For example: <code>app-encryption-key-v1</code> encoded as bytes.
                    </div>
                  </div>

                  <div class="check-item">
                    <div class="check-item-header">
                      <span class="check-item-name">
                        <span class="dot-indicator ok"></span>
                        <span>2Ô∏è‚É£ Authenticator computes HMAC</span>
                      </span>
                    </div>
                    <div class="check-item-summary">
                      The authenticator uses your passkey's internal secret combined with your salt to compute an HMAC-SHA-256. This happens securely inside the authenticator hardware.
                    </div>
                  </div>

                  <div class="check-item">
                    <div class="check-item-header">
                      <span class="check-item-name">
                        <span class="dot-indicator ok"></span>
                        <span>3Ô∏è‚É£ You receive a derived key</span>
                      </span>
                    </div>
                    <div class="check-item-summary">
                      You get back 32 bytes of cryptographically secure output that you can use as an encryption key, HMAC key, or derive further keys using HKDF.
                    </div>
                  </div>

                  <div class="check-item">
                    <div class="check-item-header">
                      <span class="check-item-name">
                        <span class="dot-indicator ok"></span>
                        <span>4Ô∏è‚É£ Same input = same output, always</span>
                      </span>
                    </div>
                    <div class="check-item-summary">
                      The same passkey + same salt will always produce the identical derived key. This is what makes it useful for encryption ‚Äî you can always regenerate the key when needed.
                    </div>
                  </div>
                </div>
              </div>

              <!-- Use Cases -->
              <div class="prf-education-block" style="margin-top: 16px;">
                <div class="section-label">üí° Real-World Use Cases</div>
                <div class="use-case-box" style="margin-top: 8px;">
                  <div class="use-case-title">üîí End-to-End Encrypted Notes</div>
                  <div class="use-case-text">
                    Encrypt user notes client-side with a key derived from their passkey. The server never sees the encryption key ‚Äî only the user with the passkey can decrypt their data.
                  </div>
                </div>
                <div class="use-case-box" style="margin-top: 8px;">
                  <div class="use-case-title">üí∞ Crypto Wallet Seed Recovery</div>
                  <div class="use-case-text">
                    Derive a deterministic seed for a cryptocurrency wallet. If the user loses their device, their synced passkey can regenerate the same seed on any device.
                  </div>
                </div>
                <div class="use-case-box" style="margin-top: 8px;">
                  <div class="use-case-title">üìÅ Zero-Knowledge File Storage</div>
                  <div class="use-case-text">
                    Encrypt files before uploading to cloud storage. The cloud provider can't read your files because only your passkey can derive the decryption key.
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Right: Support Check -->
          <div class="card">
            <div class="card-inner">
              <div class="card-header">
                <div>
                  <div class="card-title">üß™ Support Check</div>
                  <div class="card-subtitle">Test if your browser and device support PRF</div>
                </div>
                <div id="prfSupportBadge" class="badge warn">
                  <span class="badge-dot"></span>
                  <span id="prfSupportStatus">Not tested</span>
                </div>
              </div>

              <div class="info-box">
                <strong>How this test works:</strong><br>
                We'll create a temporary passkey with the PRF extension enabled, then check if the authenticator returns PRF support information. You'll need to complete the WebAuthn prompt.
              </div>

              <div class="section-actions" style="margin-top: 12px;">
                <button id="testPrfSupportBtn" class="primary">
                  <span>üé≤</span>
                  <span>Test PRF Support</span>
                </button>
              </div>

              <!-- PRF Test Results -->
              <div id="prfTestResults" class="check-list" style="margin-top: 16px;">
                <div class="check-item" style="opacity: 0.5;">
                  <div class="check-item-description">
                    Click "Test PRF Support" to check if PRF works on your device.
                  </div>
                </div>
              </div>

              <!-- Code Examples -->
              <div style="margin-top: 20px;">
                <div class="section-label">Code Examples</div>
                
                <div class="check-item" style="margin-top: 8px;">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span>üìù</span>
                      <span>Check PRF Support (during registration)</span>
                    </span>
                  </div>
                  <div class="code-example">const credential = await navigator.credentials.create({
  publicKey: {
    // ... other options ...
    extensions: {
      prf: {}  // Empty object to check support
    }
  }
});

const results = credential.getClientExtensionResults();
if (results.prf?.enabled) {
  console.log("PRF is supported!");
}</div>
                </div>

                <div class="check-item" style="margin-top: 10px;">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span>üîë</span>
                      <span>Derive a Key (during authentication)</span>
                    </span>
                  </div>
                  <div class="code-example">// Create your salt (must be exactly 32 bytes)
const salt = new TextEncoder().encode("my-app-encryption-key-salt-v1!!!");

const assertion = await navigator.credentials.get({
  publicKey: {
    challenge: challenge,
    rpId: "example.com",
    extensions: {
      prf: {
        eval: {
          first: salt  // Your 32-byte salt
        }
      }
    }
  }
});

const results = assertion.getClientExtensionResults();
const derivedKey = results.prf?.results?.first;
// derivedKey is a 32-byte ArrayBuffer you can use for encryption</div>
                </div>

                <div class="check-item" style="margin-top: 10px;">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span>üîê</span>
                      <span>Use Derived Key for Encryption</span>
                    </span>
                  </div>
                  <div class="code-example">// Import the derived key for AES-GCM encryption
const cryptoKey = await crypto.subtle.importKey(
  "raw",
  derivedKey,
  { name: "AES-GCM" },
  false,
  ["encrypt", "decrypt"]
);

// Encrypt some data
const iv = crypto.getRandomValues(new Uint8Array(12));
const encrypted = await crypto.subtle.encrypt(
  { name: "AES-GCM", iv: iv },
  cryptoKey,
  new TextEncoder().encode("Secret message")
);</div>
                </div>
              </div>

              <!-- Live PRF Demo -->
              <div id="prfDemoSection" style="display: none; margin-top: 20px;">
                <div class="section-label">üéÆ Live Demo: Derive a Key</div>
                <div class="hint-result" style="margin-top: 8px;">
                  <div class="hint-result-content">
                    <label style="display: block; margin-bottom: 8px;">
                      <span style="font-size: 0.78rem; color: var(--text-muted);">Enter a salt value (will be padded/truncated to 32 bytes):</span>
                      <input type="text" id="prfSaltInput" placeholder="my-encryption-salt" 
                        style="width: 100%; margin-top: 4px; padding: 10px 12px; background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 8px; color: var(--text-main); font-size: 0.85rem;">
                    </label>
                    <button id="derivePrfKeyBtn" class="secondary" style="margin-top: 8px;">
                      <span>üîë</span>
                      <span>Derive Key</span>
                    </button>
                    <div id="prfDerivedKeyResult" style="margin-top: 12px; display: none;">
                      <div style="font-size: 0.72rem; text-transform: uppercase; color: var(--text-muted); margin-bottom: 4px;">Derived Key (hex):</div>
                      <code id="prfDerivedKeyHex" style="display: block; padding: 10px; background: rgba(0,0,0,0.4); border-radius: 8px; font-size: 0.72rem; word-break: break-all; color: var(--success);"></code>
                    </div>
                  </div>
                </div>
              </div>

              <div class="info-box" style="margin-top: 16px;">
                <strong>‚ö†Ô∏è Browser Support</strong><br>
                PRF is supported in Chrome 109+, Edge 109+, and Safari 17+. Firefox support is planned. The authenticator must also support the hmac-secret CTAP2 extension.
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ========== Section: Conditional UI (Create/Get) ========== -->
      <section id="section-conditional" class="check-section">
        <div class="section-header">
          <div class="section-title-block">
            <h2>
              <span>‚ú®</span>
              Conditional UI (Create & Get)
            </h2>
            <p>
              Enable seamless passkey experiences with autofill integration and non-intrusive credential creation.
            </p>
          </div>
        </div>

        <div class="card-grid">
          <!-- Left: Education -->
          <div class="card">
            <div class="card-inner">
              <div class="card-header">
                <div>
                  <div class="card-title">üìö Education</div>
                  <div class="card-subtitle">Understanding Conditional UI mediation</div>
                </div>
              </div>

              <!-- What is Conditional UI -->
              <div class="conditional-education-block">
                <div class="section-label">What is Conditional UI?</div>
                <div class="info-box" style="margin-top: 8px;">
                  <p style="margin: 0 0 12px;">
                    <strong>Conditional UI</strong> is a WebAuthn mediation mode that integrates passkeys directly into the browser's native autofill experience ‚Äî making passwordless login feel as natural as using saved passwords.
                  </p>
                  <p style="margin: 0 0 12px;">
                    Instead of immediately showing a modal WebAuthn prompt, conditional UI waits for the <strong>user to interact</strong> with an input field, then shows passkeys alongside other autofill suggestions.
                  </p>
                  <p style="margin: 0;">
                    üéØ <strong>Key insight:</strong> This removes the friction of modal dialogs and lets users discover passkeys naturally in a UI they already understand.
                  </p>
                </div>
              </div>

              <!-- Conditional Get -->
              <div class="conditional-education-block" style="margin-top: 16px;">
                <div class="section-label">üîë Conditional Get (Autofill Login)</div>
                <div class="check-list" style="margin-top: 8px;">
                  <div class="check-item">
                    <div class="check-item-header">
                      <span class="check-item-name">
                        <span class="dot-indicator ok"></span>
                        <span>Passkeys appear in autofill dropdown</span>
                      </span>
                    </div>
                    <div class="check-item-summary">
                      When users focus a login field with <code>autocomplete="username webauthn"</code>, their passkeys appear right alongside saved passwords.
                    </div>
                  </div>

                  <div class="check-item">
                    <div class="check-item-header">
                      <span class="check-item-name">
                        <span class="dot-indicator ok"></span>
                        <span>No modal popup interruption</span>
                      </span>
                    </div>
                    <div class="check-item-summary">
                      The authentication request runs silently in the background until the user actually selects a passkey from autofill.
                    </div>
                  </div>

                  <div class="check-item">
                    <div class="check-item-header">
                      <span class="check-item-name">
                        <span class="dot-indicator ok"></span>
                        <span>Single-tap authentication</span>
                      </span>
                    </div>
                    <div class="check-item-summary">
                      User taps their passkey in autofill ‚Üí biometric prompt ‚Üí done. It's as easy as autofilling a password.
                    </div>
                  </div>
                </div>

                <div class="use-case-box" style="margin-top: 12px;">
                  <div class="use-case-title">üí° When to use Conditional Get</div>
                  <div class="use-case-text">
                    Use on <strong>every login page</strong>. Start the conditional request on page load, and let users choose between passkeys, passwords, or other login methods naturally.
                  </div>
                </div>
              </div>

              <!-- Conditional Create -->
              <div class="conditional-education-block" style="margin-top: 16px;">
                <div class="section-label">‚ú® Conditional Create (Deferred Registration)</div>
                <div class="check-list" style="margin-top: 8px;">
                  <div class="check-item">
                    <div class="check-item-header">
                      <span class="check-item-name">
                        <span class="dot-indicator ok"></span>
                        <span>Prepare passkey creation silently</span>
                      </span>
                    </div>
                    <div class="check-item-summary">
                      Check if the device supports passkeys and prepare all parameters without triggering any UI.
                    </div>
                  </div>

                  <div class="check-item">
                    <div class="check-item-header">
                      <span class="check-item-name">
                        <span class="dot-indicator ok"></span>
                        <span>Wait for user intent</span>
                      </span>
                    </div>
                    <div class="check-item-summary">
                      Only show the passkey creation prompt when the user explicitly clicks "Create Passkey" or similar.
                    </div>
                  </div>

                  <div class="check-item">
                    <div class="check-item-header">
                      <span class="check-item-name">
                        <span class="dot-indicator ok"></span>
                        <span>Graceful fallback</span>
                      </span>
                    </div>
                    <div class="check-item-summary">
                      If passkeys aren't supported, you know before the user clicks ‚Äî no awkward error dialogs.
                    </div>
                  </div>
                </div>

                <div class="use-case-box" style="margin-top: 12px;">
                  <div class="use-case-title">üí° When to use Conditional Create</div>
                  <div class="use-case-text">
                    Use during <strong>onboarding flows</strong> or <strong>settings pages</strong> where you want to offer passkey creation at the right moment, not immediately on page load.
                  </div>
                </div>
              </div>

              <!-- How it works diagram -->
              <div class="conditional-education-block" style="margin-top: 16px;">
                <div class="section-label">‚öôÔ∏è How Does It Work?</div>
                <div class="check-list" style="margin-top: 8px;">
                  <div class="check-item">
                    <div class="check-item-header">
                      <span class="check-item-name">
                        <span>1Ô∏è‚É£</span>
                        <span>Add autocomplete attribute to input</span>
                      </span>
                    </div>
                    <div class="code-example" style="margin-top: 6px;">&lt;input type="text" autocomplete="username webauthn"&gt;</div>
                  </div>

                  <div class="check-item">
                    <div class="check-item-header">
                      <span class="check-item-name">
                        <span>2Ô∏è‚É£</span>
                        <span>Start conditional request on page load</span>
                      </span>
                    </div>
                    <div class="code-example" style="margin-top: 6px;">const credential = await navigator.credentials.get({
  publicKey: { challenge, rpId, ... },
  mediation: "conditional"  // ‚Üê The magic
});</div>
                  </div>

                  <div class="check-item">
                    <div class="check-item-header">
                      <span class="check-item-name">
                        <span>3Ô∏è‚É£</span>
                        <span>User interacts with input field</span>
                      </span>
                    </div>
                    <div class="check-item-summary">
                      Browser shows passkeys in autofill UI alongside saved passwords.
                    </div>
                  </div>

                  <div class="check-item">
                    <div class="check-item-header">
                      <span class="check-item-name">
                        <span>4Ô∏è‚É£</span>
                        <span>User selects passkey ‚Üí biometric ‚Üí done</span>
                      </span>
                    </div>
                    <div class="check-item-summary">
                      The promise resolves with the credential assertion.
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Right: Support Check -->
          <div class="card">
            <div class="card-inner">
              <div class="card-header">
                <div>
                  <div class="card-title">üß™ Support Check</div>
                  <div class="card-subtitle">Test if your browser supports Conditional UI</div>
                </div>
                <div id="conditionalSupportBadge" class="badge warn">
                  <span class="badge-dot"></span>
                  <span id="conditionalSupportStatus">Not tested</span>
                </div>
              </div>

              <div class="info-box">
                <strong>How this test works:</strong><br>
                We'll check if <code>isConditionalMediationAvailable()</code> returns true for Get, and if <code>getClientCapabilities()</code> reports <code>conditionalCreate</code> support for Create. No WebAuthn prompt required!
              </div>

              <div class="section-actions" style="margin-top: 12px;">
                <button id="testConditionalSupportBtn" class="primary">
                  <span>‚ú®</span>
                  <span>Test Conditional Support</span>
                </button>
              </div>

              <!-- Conditional Test Results -->
              <div id="conditionalTestResults" class="check-list" style="margin-top: 16px;">
                <div class="check-item" style="opacity: 0.5;">
                  <div class="check-item-description">
                    Click "Test Conditional Support" to check browser capabilities.
                  </div>
                </div>
              </div>

              <!-- Code Examples -->
              <div style="margin-top: 20px;">
                <div class="section-label">Code Examples</div>
                
                <div class="check-item" style="margin-top: 8px;">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span>üîç</span>
                      <span>Check Conditional Get Support</span>
                    </span>
                  </div>
                  <div class="code-example">// Check before using conditional mediation
const supported = await PublicKeyCredential
  .isConditionalMediationAvailable();

if (supported) {
  // Safe to use mediation: "conditional"
  console.log("Conditional UI is supported!");
}</div>
                </div>

                <div class="check-item" style="margin-top: 10px;">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span>üîë</span>
                      <span>Conditional Get (Autofill Login)</span>
                    </span>
                  </div>
                  <div class="code-example">// Start this on page load
const abortController = new AbortController();

try {
  const credential = await navigator.credentials.get({
    publicKey: {
      challenge: new Uint8Array(32),
      rpId: "example.com",
      userVerification: "preferred"
    },
    mediation: "conditional",
    signal: abortController.signal
  });
  
  // User selected a passkey from autofill!
  console.log("Authenticated:", credential);
} catch (e) {
  if (e.name !== "AbortError") throw e;
}</div>
                </div>

                <div class="check-item" style="margin-top: 10px;">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span>‚ú®</span>
                      <span>Conditional Create (Deferred)</span>
                    </span>
                  </div>
                  <div class="code-example">// Check if conditional create is supported
const caps = await PublicKeyCredential.getClientCapabilities();
if (caps.conditionalCreate) {
  // Can use mediation: "conditional" with create
}

// Prepare credential options
const options = {
  publicKey: {
    challenge: new Uint8Array(32),
    rp: { name: "Example", id: "example.com" },
    user: { id: userId, name: email, displayName: name },
    pubKeyCredParams: [{ type: "public-key", alg: -7 }],
    authenticatorSelection: {
      residentKey: "required",
      userVerification: "preferred"
    }
  },
  mediation: "conditional"
};

// Call when user clicks "Create Passkey"
const credential = await navigator.credentials.create(options);</div>
                </div>

                <div class="check-item" style="margin-top: 10px;">
                  <div class="check-item-header">
                    <span class="check-item-name">
                      <span>üìù</span>
                      <span>HTML Input Setup</span>
                    </span>
                  </div>
                  <div class="code-example">&lt;!-- For username/email field --&gt;
&lt;input 
  type="text" 
  autocomplete="username webauthn"
  placeholder="Email or username"
&gt;

&lt;!-- For password field (passkeys still show) --&gt;
&lt;input 
  type="password" 
  autocomplete="current-password webauthn"
&gt;</div>
                </div>
              </div>

              <!-- Live Demo Section -->
              <div style="margin-top: 20px;">
                <div class="section-label">üéÆ Live Demo: Autofill Input</div>
                <div class="hint-result" style="margin-top: 8px;">
                  <div class="hint-result-content">
                    <p style="margin: 0 0 12px; font-size: 0.8rem; color: var(--text-muted);">
                      Focus this input to see if passkeys appear in your browser's autofill menu. This demonstrates how Conditional Get integrates with native browser UI.
                    </p>
                    <input 
                      type="text" 
                      id="conditionalDemoInput"
                      autocomplete="username webauthn"
                      placeholder="Focus me to see passkey autofill..."
                      style="width: 100%; padding: 12px 14px; background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 8px; color: var(--text-main); font-size: 0.9rem;"
                    >
                    <div style="margin-top: 10px; display: flex; gap: 8px;">
                      <button id="startConditionalGetBtn" class="secondary">
                        <span>‚ñ∂</span>
                        <span>Start Conditional Get</span>
                      </button>
                      <button id="abortConditionalGetBtn" class="secondary" disabled>
                        <span>‚èπ</span>
                        <span>Abort</span>
                      </button>
                    </div>
                    <div id="conditionalGetStatus" style="margin-top: 10px; font-size: 0.78rem; color: var(--text-muted);">
                      Click "Start Conditional Get" to begin listening for passkey selection.
                    </div>
                  </div>
                </div>
              </div>

              <div class="info-box" style="margin-top: 16px;">
                <strong>‚ö†Ô∏è Browser Support</strong><br>
                <strong>Conditional Get:</strong> Chrome 108+, Safari 16+, Edge 108+, Firefox 122+<br>
                <strong>Conditional Create:</strong> Chrome 128+, Safari 18+ (newer feature)
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- ===== Footer ===== -->
    <footer>
      <div>üí° Compare results across browsers/devices to understand passkey support differences.</div>
      <div>
        <a class="footer-link" href="https://www.w3.org/TR/webauthn-3/" target="_blank" rel="noreferrer">
          WebAuthn Level 3 Spec ‚Üó
        </a>
        &nbsp;¬∑&nbsp;
        <a class="footer-link" href="https://passkeys.dev" target="_blank" rel="noreferrer">
          passkeys.dev ‚Üó
        </a>
      </div>
    </footer>
  </div>

  <script src="app.js"></script>
</body>
</html>
